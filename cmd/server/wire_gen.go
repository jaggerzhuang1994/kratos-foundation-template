// Code generated by Wire. DO NOT EDIT.

//go:generate go run -mod=mod github.com/google/wire/cmd/wire
//go:build !wireinject
// +build !wireinject

package main

import (
	"github.com/go-kratos/kratos/v2"
	"github.com/jaggerzhuang1994/kratos-foundation-template/api/example_service/example_pb"
	"github.com/jaggerzhuang1994/kratos-foundation-template/internal/biz/example/user1"
	"github.com/jaggerzhuang1994/kratos-foundation-template/internal/biz/example/user2"
	"github.com/jaggerzhuang1994/kratos-foundation-template/internal/biz/example/user3"
	client2 "github.com/jaggerzhuang1994/kratos-foundation-template/internal/client"
	"github.com/jaggerzhuang1994/kratos-foundation-template/internal/conf"
	"github.com/jaggerzhuang1994/kratos-foundation-template/internal/data"
	"github.com/jaggerzhuang1994/kratos-foundation-template/internal/service"
	"github.com/jaggerzhuang1994/kratos-foundation/pkg/app"
	"github.com/jaggerzhuang1994/kratos-foundation/pkg/app_info"
	"github.com/jaggerzhuang1994/kratos-foundation/pkg/client"
	"github.com/jaggerzhuang1994/kratos-foundation/pkg/config"
	"github.com/jaggerzhuang1994/kratos-foundation/pkg/consul"
	"github.com/jaggerzhuang1994/kratos-foundation/pkg/context"
	"github.com/jaggerzhuang1994/kratos-foundation/pkg/database"
	"github.com/jaggerzhuang1994/kratos-foundation/pkg/discovery"
	"github.com/jaggerzhuang1994/kratos-foundation/pkg/job"
	"github.com/jaggerzhuang1994/kratos-foundation/pkg/job/otel"
	"github.com/jaggerzhuang1994/kratos-foundation/pkg/log"
	"github.com/jaggerzhuang1994/kratos-foundation/pkg/metrics"
	"github.com/jaggerzhuang1994/kratos-foundation/pkg/redis"
	"github.com/jaggerzhuang1994/kratos-foundation/pkg/registry"
	"github.com/jaggerzhuang1994/kratos-foundation/pkg/server"
	"github.com/jaggerzhuang1994/kratos-foundation/pkg/tracing"
)

import (
	_ "github.com/jaggerzhuang1994/kratos-foundation/pkg/setup"
	_ "go.uber.org/automaxprocs"
)

// Injectors from wire.go:

// wireApp init kratos application.
func wireApp(version app_info.Version, fileConfigSource conf.FileConfigSource) (*kratos.App, func(), error) {
	appInfo := app_info.NewAppInfo(version)
	presetKv := log.NewPresetKv(appInfo)
	defaultConfig := log.NewDefaultConfig()
	hook := log.NewHook()
	logger, cleanup, err := log.NewLogger(presetKv, defaultConfig, hook)
	if err != nil {
		return nil, nil, err
	}
	logLog := log.NewLog(logger)
	fileSourcePathList, err := conf.NewFileSource(appInfo, fileConfigSource)
	if err != nil {
		cleanup()
		return nil, nil, err
	}
	fileSource, err := config.NewFileSource(logLog, fileSourcePathList)
	if err != nil {
		cleanup()
		return nil, nil, err
	}
	v, err := consul.NewConsul(logLog)
	if err != nil {
		cleanup()
		return nil, nil, err
	}
	consulSourcePathList := conf.NewConsulSource(appInfo)
	consulSource := config.NewConsulSource(v, logLog, consulSourcePathList)
	v2, cleanup2, err := config.NewConfig(fileSource, consulSource)
	if err != nil {
		cleanup()
		return nil, nil, err
	}
	v3, err := config.NewKratosFoundationConfig(v2, logger)
	if err != nil {
		cleanup2()
		cleanup()
		return nil, nil, err
	}
	serverDefaultConfig := server.NewDefaultConfig()
	v4 := server.NewConfig(v3, serverDefaultConfig)
	metricsDefaultConfig := metrics.NewDefaultConfig(appInfo)
	v5 := metrics.NewConfig(v3, metricsDefaultConfig)
	serviceAttributes := app_info.NewServiceAttributes(appInfo)
	v6, err := metrics.NewMetrics(logLog, v5, serviceAttributes)
	if err != nil {
		cleanup2()
		cleanup()
		return nil, nil, err
	}
	tracingDefaultConfig := tracing.NewDefaultConfig(appInfo)
	v7 := tracing.NewConfig(v3, tracingDefaultConfig)
	exporter, err := tracing.NewExporter(v7)
	if err != nil {
		cleanup2()
		cleanup()
		return nil, nil, err
	}
	sampler := tracing.NewSampler(v7, logLog)
	tracerProvider, cleanup3 := tracing.NewTracerProvider(v7, exporter, sampler, serviceAttributes)
	v8 := tracing.NewTracing(v7, tracerProvider, serviceAttributes)
	middlewares := server.NewMiddlewares(v4, logLog, v6, v8)
	httpServerOptions := server.NewHttpServerOptions(v4, middlewares)
	v9 := server.NewHttpServer(v4, httpServerOptions)
	grpcServerOptions := server.NewGrpcServerOptions(v4, middlewares)
	v10 := server.NewGrpcServer(v4, grpcServerOptions)
	websocketServer := server.NewWebsocketServer(logLog, v9)
	jobDefaultConfig := job.NewDefaultConfig()
	v11 := job.NewConfig(v3, jobDefaultConfig)
	register := job.NewRegister(v11)
	appHook := app.NewHook()
	contextHook := context.NewHook()
	databaseDefaultConfig := database.NewDefaultConfig()
	v12 := database.NewConfig(v3, databaseDefaultConfig)
	connectionFactory := database.NewConnectionFactory()
	defaultConnection, err := database.NewDefaultConnection(connectionFactory, v12)
	if err != nil {
		cleanup3()
		cleanup2()
		cleanup()
		return nil, nil, err
	}
	gormLogger := database.NewGormLogger(logLog, v12)
	gormConfig := database.NewGormConfig(v12, gormLogger)
	tracingPlugin := database.NewTracingPlugin(v12, v8, serviceAttributes)
	metricsPlugin := database.NewMetricsPlugin(v12, serviceAttributes)
	dbResolver, err := database.NewDbResolver(v12, defaultConnection, connectionFactory)
	if err != nil {
		cleanup3()
		cleanup2()
		cleanup()
		return nil, nil, err
	}
	manager, err := database.NewManager(logLog, v12, defaultConnection, gormConfig, tracingPlugin, metricsPlugin, dbResolver)
	if err != nil {
		cleanup3()
		cleanup2()
		cleanup()
		return nil, nil, err
	}
	userDbRepo := data.NewUserDbRepo(manager)
	user1Biz := user1.NewUser1Biz(userDbRepo)
	redisDefaultConfig := redis.NewDefaultConfig()
	v13 := redis.NewConfig(v3, redisDefaultConfig)
	redisManager, cleanup4, err := redis.NewManager(logLog, v13, v8, v6, serviceAttributes)
	if err != nil {
		cleanup3()
		cleanup2()
		cleanup()
		return nil, nil, err
	}
	userCacheRepo := data.NewUserCacheRepo(redisManager)
	user2Biz := user2.NewUser2Biz(userCacheRepo)
	clientDefaultConfig := client.NewDefaultConfig()
	v14 := client.NewConfig(v3, clientDefaultConfig)
	discoveryDefaultConfig := discovery.NewDefaultConfig()
	v15 := discovery.NewConfig(v3, discoveryDefaultConfig)
	v16 := discovery.NewDiscovery(logLog, v15, v)
	factory := client.NewFactory(v14, logLog, v8, v6, v16)
	exampleServiceApiWrapper := example_pb.NewExampleServiceApiWrapper(factory)
	biz3GetUserImpl := client2.NewBiz3GetUserImpl(exampleServiceApiWrapper)
	bootstrap, err := conf.NewBootstrap(v2)
	if err != nil {
		cleanup4()
		cleanup3()
		cleanup2()
		cleanup()
		return nil, nil, err
	}
	user3Biz := user3.NewUser3Biz(biz3GetUserImpl, bootstrap)
	exampleService := service.NewExampleService(user1Biz, user2Biz, user3Biz)
	exampleWsHandler := service.NewExampleWsHandler()
	bootstrapBootstrap := NewBootstrap(logLog, v9, v10, websocketServer, register, appHook, contextHook, hook, exampleService, exampleWsHandler)
	appDefaultConfig := app.NewDefaultConfig()
	v17 := app.NewConfig(v3, appDefaultConfig)
	registryDefaultConfig := registry.NewDefaultConfig()
	v18 := registry.NewConfig(v3, registryDefaultConfig)
	v19 := registry.NewRegistry(logLog, v18, v)
	contextContext, cleanup5, err := context.NewContext(contextHook, appInfo, logLog, v19, v16, v6, v8)
	if err != nil {
		cleanup4()
		cleanup3()
		cleanup2()
		cleanup()
		return nil, nil, err
	}
	jobLog := job.NewLog(logLog, v11)
	tracingProvider := otel.NewTracingProvider(v8, v11)
	metricsProvider, err := otel.NewMetricsProvider(v6, v11)
	if err != nil {
		cleanup5()
		cleanup4()
		cleanup3()
		cleanup2()
		cleanup()
		return nil, nil, err
	}
	jobMiddlewares := job.NewMiddleware(jobLog, tracingProvider, metricsProvider)
	cronLog := job.NewCronLog(logLog, v11)
	scheduleParser := job.NewScheduleParser(cronLog)
	cronLogger := job.NewCronLogger(cronLog)
	cron, err := job.NewCron(cronLog, v11, scheduleParser, cronLogger)
	if err != nil {
		cleanup5()
		cleanup4()
		cleanup3()
		cleanup2()
		cleanup()
		return nil, nil, err
	}
	jobServer, err := job.NewServer(jobLog, jobMiddlewares, register, cron, scheduleParser)
	if err != nil {
		cleanup5()
		cleanup4()
		cleanup3()
		cleanup2()
		cleanup()
		return nil, nil, err
	}
	serverRegister := server.NewRegister(v4, v9, v10, jobServer)
	kratosApp := app.NewApp(bootstrapBootstrap, v17, appHook, appInfo, contextContext, logger, serverRegister, v19)
	return kratosApp, func() {
		cleanup5()
		cleanup4()
		cleanup3()
		cleanup2()
		cleanup()
	}, nil
}
